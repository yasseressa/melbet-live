datasource db {
  provider = "mysql"
}

generator client {
  provider = "prisma-client-js"
}

model User {
  id        String   @id @default(cuid())
  email     String   @unique
  name      String?
  role      Role     @default(ADMIN)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

enum Role {
  ADMIN
  EDITOR
}

model Team {
  id        String   @id @default(cuid())
  externalId Int?    @unique
  nameAr    String
  nameEn    String?
  shortName String?
  logoUrl   String?
  createdAt DateTime @default(now())

  homeMatches Match[] @relation("HomeTeam")
  awayMatches Match[] @relation("AwayTeam")
}

model Competition {
  id        String   @id @default(cuid())
  externalId Int?    @unique
  nameAr    String
  nameEn    String?
  country   String?
  logoUrl   String?
  createdAt DateTime @default(now())

  matches   Match[]
}

model Match {
  id            String      @id @default(cuid())
  externalId    Int?        @unique
  slug          String      @unique
  startsAt      DateTime
  status        MatchStatus @default(SCHEDULED)

  homeTeamId    String
  awayTeamId    String
  competitionId String

  homeTeam      Team        @relation("HomeTeam", fields: [homeTeamId], references: [id])
  awayTeam      Team        @relation("AwayTeam", fields: [awayTeamId], references: [id])
  competition   Competition @relation(fields: [competitionId], references: [id])

  streams       Stream[]
  createdAt     DateTime    @default(now())
  updatedAt     DateTime    @updatedAt

  @@index([startsAt])
  @@index([competitionId])
}

enum MatchStatus {
  SCHEDULED
  LIVE
  FINISHED
  POSTPONED
}

model Stream {
  id          String   @id @default(cuid())
  matchId     String
  provider    String?
  playbackUrl String
  isPrimary   Boolean  @default(true)
  enabled     Boolean  @default(true)
  createdAt   DateTime @default(now())

  match       Match    @relation(fields: [matchId], references: [id])

  @@index([matchId])
}

model NewsCategory {
  id     String @id @default(cuid())
  nameAr String @unique
  nameEn String?
  news   News[]
}

model News {
  id            String   @id @default(cuid())
  slug          String   @unique
  sourceLang    NewsLang @default(EN)
  titleAr       String
  titleEn       String?
  excerptAr     String?
  excerptEn     String?
  contentHtmlAr String
  contentHtmlEn String?
  coverUrl      String?
  publishedAt   DateTime @default(now())
  categoryId    String?

  category      NewsCategory? @relation(fields: [categoryId], references: [id])

  @@index([publishedAt])
  @@index([sourceLang, publishedAt])
}

enum NewsLang {
  AR
  EN
}

model SocialLink {
  id      String     @id @default(cuid())
  kind    SocialKind @unique
  url     String
  enabled Boolean    @default(true)
}

enum SocialKind {
  TELEGRAM
  WHATSAPP
  EMAIL
  INSTAGRAM
  FACEBOOK
}

model PopupLink {
  id      String @id @default(cuid())
  titleAr String
  titleEn String?
  url     String
  enabled Boolean @default(true)
  sort    Int     @default(0)

  @@index([sort])
}

